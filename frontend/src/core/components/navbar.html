<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>Document</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script src="https://cdn.tailwindcss.com"></script>
    </head> 
    <body> 
        <header class="w-full px-6 py-4 flex justify-between items-center bg-white shadow"> 
            <div class="flex items-center space-x-8"> 
                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"> 
                    <span class="text-blue-500 font-bold text-lg">J</span> 
                </div> 
                <nav class="hidden md:flex items-center space-x-8 text-gray-600"> 
                    <a class="hover:text-gray-900" href="../../../customer/home/landing/landing.html">Home</a> 
                    <a class="hover:text-gray-900" href="../../../customer/shop/browse/browse.html">Shop</a> 
                    <a class="hover:text-gray-900" href="orders.html">Orders</a> 
                    <a class="hover:text-gray-900" href="../../../customer/about/contact/contact.html">Contact us</a> 
                </nav> 
            </div> 
            <div class="flex items-center space-x-4" id="auth-section">
                <button class="text-gray-600 hover:text-gray-900">
                  <a href="../../../customer/shop/cart/cart.html">
                    <span class="material-icons">shopping_cart</span>
                  </a>
                </button>
              
                <!-- This part will be replaced by JS -->
                <a href="../../../customer/auth/login/login.html" 
                   class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                  Login
                </a>
            </div>
        </header> 
        <script>
            (function () {
                async function renderAuth() {
                    const authSection = document.getElementById("auth-section");
                    if (!authSection) return;
            
                    // Keep cart button
                    const cartButton = authSection.querySelector('button:first-child');
                    authSection.innerHTML = '';
                    if (cartButton) authSection.appendChild(cartButton);
            
                    try {
                        // Fetch current user from endpoint
                        const response = await fetch("http://localhost:3000/user", {
                            method: "GET",
                            headers: {
                                "Content-Type": "application/json"
                            }
                        });
            
                        let currentUser = null;
            
                        if (response.ok) {
                            currentUser = await response.json();
                        }
            
                        if (currentUser && currentUser.email) {
                            // Show user info and logout button
                            const userSection = document.createElement('div');
                            userSection.className = 'flex items-center space-x-4';
                            userSection.innerHTML = `
                                <span class="text-gray-700 font-semibold">Hi, ${currentUser.email}</span>
                                <button id="logoutBtn" class="ml-4 px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600">
                                    Logout
                                </button>
                            `;
                            authSection.appendChild(userSection);
            
                            const logoutBtn = document.getElementById("logoutBtn");
                            if (logoutBtn) {
                                logoutBtn.addEventListener("click", () => {
                                    // If you want, you can also notify backend to logout
                                    window.location.href = "../../../customer/home/landing/landing.html";
                                });
                            }
                        } else {
                            // No user â†’ show login
                            const loginLink = document.createElement('a');
                            loginLink.href = "../../../customer/auth/login/login.html";
                            loginLink.className = "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition";
                            loginLink.textContent = "Login";
                            authSection.appendChild(loginLink);
                        }
                    } catch (error) {
                        console.error("Error fetching user:", error);
            
                        // Fallback to login button
                        const loginLink = document.createElement('a');
                        loginLink.href = "../../../customer/auth/login/login.html";
                        loginLink.className = "px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition";
                        loginLink.textContent = "Login";
                        authSection.appendChild(loginLink);
                    }
                }
            
                // Expose init function
                window.initAuth = renderAuth;
            
                document.addEventListener("DOMContentLoaded", renderAuth);
            })();
            </script>
            
    </body>
</html>

 <!-- <!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Conditional Header</title>
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   <script>
     document.addEventListener("DOMContentLoaded", () => {
       // ðŸš¨ Clear this for testing: localStorage.removeItem("user");
       localStorage.removeItem("user");

       const user = JSON.parse(localStorage.getItem("user")); 
       const userSection = document.getElementById("user-section");
 
       if (user) {
         userSection.innerHTML = `
           <div class="flex items-center space-x-3">
             <img src="${user.avatar || 'https://via.placeholder.com/40'}" 
                  alt="User avatar" class="w-8 h-8 rounded-full border">
             <span class="text-gray-700 font-medium">${user.name}</span>
           </div>
         `;
       } else {
         userSection.innerHTML = `
           <a href="../../../customer/auth/login.html" 
              style="padding:6px 12px; background:#2563eb; color:white; border-radius:6px; text-decoration:none;">
             Login
           </a>
         `;
       }
     });
   </script>
 </head>
 <body>
   <header style="width:100%; padding:16px; display:flex; justify-content:space-between; align-items:center; background:white; box-shadow:0 2px 4px rgba(0,0,0,0.1);">
     <div style="display:flex; align-items:center; gap:20px;">
       <div style="width:32px; height:32px; background:#dbeafe; border-radius:50%; display:flex; align-items:center; justify-content:center;">
         <span style="color:#2563eb; font-weight:bold;">J</span>
       </div>
       <nav style="display:flex; gap:20px; color:#4b5563;">
         <a href="../../../customer/home/landing/landing.html">Home</a>
         <a href="../../../customer/shop/browse/browse.html">Shop</a>
         <a href="orders.html">Orders</a>
         <a href="../../../customer/about/contact/contact.html">Contact us</a>
       </nav>
     </div>
     <div style="display:flex; align-items:center; gap:16px;">
       <a href="../../../customer/shop/cart/cart.html"><span class="material-icons">shopping_cart</span></a>
     
       <div id="user-section"></div>
     </div>
   </header>
 </body>
 </html> -->
 
 